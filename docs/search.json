[
  {
    "objectID": "global_splicing.html",
    "href": "global_splicing.html",
    "title": "Global characterisation of detected splice events",
    "section": "",
    "text": "A splicing analysis of your RNA-seq data has been preformed with the MAJIQ workflow.\nThe output is split by the splicing classes and stored in .tsv files.\nThis script only looks at one of the two data sets you have (e.g. only one cell line). You should therefore perform the analyses twice, once for each data set."
  },
  {
    "objectID": "global_splicing.html#required-packages",
    "href": "global_splicing.html#required-packages",
    "title": "Global characterisation of detected splice events",
    "section": "Required packages",
    "text": "Required packages\nHere you can find the packages we need. You can install them with the install.packages() command.\n\nlibrary(dplyr) # to easily handle data.frames \nlibrary(knitr) # beautiful tables\n\nlibrary(ggplot2) # nice plots\nlibrary(ggpubr) # for even more nice plots"
  },
  {
    "objectID": "global_splicing.html#loading-the-tsv-files",
    "href": "global_splicing.html#loading-the-tsv-files",
    "title": "Global characterisation of detected splice events",
    "section": "Loading the TSV-Files",
    "text": "Loading the TSV-Files\nFirst, we load the TSV-files as data.frames into R. We are only look at the most common classes of splicing. You can see in the output folder, that you get much more TSV-files, but we will ignore all others.\n\n# --------------------\n# Input\n# --------------------\n\n# path to the folder that contains the .tsv files\nin_path &lt;- \"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/modulise/SFPQ_K562_Control-SFPQ_K562_shRNA/\"\n\n# These are the splicing classes we want to look at.\n# We make a list with the file names, and give each object in the list a name\n# the syntax is object_name = \"file_name.tsv\"\n\ninteresting_classes &lt;- list(alternative_3_prime_splice_site = \"alt3prime.tsv\",\n                         alternative_5_prime_splice_site = \"alt5prime.tsv\",\n                         cassette_exons = \"cassette.tsv\",\n                         alternative_first_exon = \"alternate_first_exon.tsv\",\n                         alternative_last_exon = \"alternate_last_exon.tsv\",\n                         mutually_exclusive_exons = \"mutually_exclusive.tsv\",\n                         intron_retention =\"alternative_intron.tsv\")\n\ninteresting_classes \n\n$alternative_3_prime_splice_site\n[1] \"alt3prime.tsv\"\n\n$alternative_5_prime_splice_site\n[1] \"alt5prime.tsv\"\n\n$cassette_exons\n[1] \"cassette.tsv\"\n\n$alternative_first_exon\n[1] \"alternate_first_exon.tsv\"\n\n$alternative_last_exon\n[1] \"alternate_last_exon.tsv\"\n\n$mutually_exclusive_exons\n[1] \"mutually_exclusive.tsv\"\n\n$intron_retention\n[1] \"alternative_intron.tsv\"\n\n\n\n# --------------------\n# Import tsvs\n# --------------------\n\n# load the content of the tsv files by looping over the interesting_classes list\nsplice_results_list &lt;- interesting_classes\n\n# read in the tsv files with a loop over all tsv files\nfor(i in 1:length(interesting_classes)){\n  \n  # we use the read_table function to import the tsv files\n  splice_results_list [[i]] = read.table(paste0(in_path, interesting_classes[[i]]),\n                       header=TRUE,\n                       sep=\"\\t\",\n                       stringsAsFactors=FALSE)\n}\n\n# the tsv files are now imported in the splice_results list\n# each object in the splice_results list are the results of one class of splicing (in data.frame format)\n\n\n# --------------------\n# have a closer look at the loop from above\n# --------------------\n\nlength(interesting_classes) # the length of the list interesting_classes\n\n[1] 7\n\n1:length(interesting_classes) # a vector from one until the length of the interesting_classes list\n\n[1] 1 2 3 4 5 6 7\n\ninteresting_classes[[3]]  %&gt;% kable() # the third object in the interesting classes results list\n\n\n\n\nx\n\n\n\n\ncassette.tsv\n\n\n\n\npaste0(in_path, interesting_classes[[3]]) # the path to the third tsv file\n\n[1] \"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/modulise/SFPQ_K562_Control-SFPQ_K562_shRNA/cassette.tsv\"\n\nhead(splice_results_list[[3]])  %&gt;% kable() # the third object in the splice results list\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodule_id\ngene_id\ngene_name\nseqid\nstrand\nlsv_id\nevent_id\ncomplex\ndenovo\nreference_exon_coord\nspliced_with\nspliced_with_coord\njunction_name\njunction_coord\nevent_size\nevent_non_changing\nevent_changing\njunction_changing\nSFPQ_K562_Control_median_psi\nSFPQ_K562_shRNA_median_psi\nSFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_non_changing\n\n\n\n\nENSG00000159685.11_2\nENSG00000159685.11\nCHCHD6\nchr3\n+\nENSG00000159685.11:s:na-126917922\nENSG00000159685.11_2_CE_1\nTrue\nTrue\n-1-126917922\nC2\n126953025-126953184\nC1_C2\n126917922-126953025\n119\nFalse\nFalse\nFalse\n0.539\n0.430\n-0.070\n0.696\n0.036\n\n\nENSG00000159685.11_2\nENSG00000159685.11\nCHCHD6\nchr3\n+\nENSG00000159685.11:s:na-126917922\nENSG00000159685.11_2_CE_1\nTrue\nTrue\n-1-126917922\nA\n126947773-126947891\nC1_A\n126917922-126947773\n119\nFalse\nFalse\nFalse\n0.192\n0.408\n0.153\n0.824\n0.011\n\n\nENSG00000159685.11_2\nENSG00000159685.11\nCHCHD6\nchr3\n+\nENSG00000159685.11:t:126953025-126953184\nENSG00000159685.11_2_CE_1\nTrue\nTrue\n126953025-126953184\nC1\n-1-126917922\nC2_C1\n126917922-126953025\n119\nFalse\nFalse\nFalse\n0.749\n0.449\n-0.247\n0.899\n0.003\n\n\nENSG00000159685.11_2\nENSG00000159685.11\nCHCHD6\nchr3\n+\nENSG00000159685.11:t:126953025-126953184\nENSG00000159685.11_2_CE_1\nTrue\nTrue\n126953025-126953184\nA\n126947773-126947891\nC2_A\n126947891-126953025\n119\nFalse\nFalse\nFalse\n0.227\n0.456\n0.160\n0.821\n0.010\n\n\nENSG00000159685.11_2\nENSG00000159685.11\nCHCHD6\nchr3\n+\nENSG00000159685.11:s:na-126917922\nENSG00000159685.11_2_CE_2\nTrue\nTrue\n-1-126917922\nC2\n126957416-126957551\nC1_C2\n126917922-126957416\n160\nFalse\nFalse\nFalse\n0.261\n0.169\n-0.064\n0.706\n0.049\n\n\nENSG00000159685.11_2\nENSG00000159685.11\nCHCHD6\nchr3\n+\nENSG00000159685.11:s:na-126917922\nENSG00000159685.11_2_CE_2\nTrue\nTrue\n-1-126917922\nA\n126953025-126953184\nC1_A\n126917922-126953025\n160\nFalse\nFalse\nFalse\n0.539\n0.430\n-0.070\n0.696\n0.036"
  },
  {
    "objectID": "global_splicing.html#cleaning-up-the-splicing-results-for-easier-usage",
    "href": "global_splicing.html#cleaning-up-the-splicing-results-for-easier-usage",
    "title": "Global characterisation of detected splice events",
    "section": "Cleaning up the splicing results for easier usage",
    "text": "Cleaning up the splicing results for easier usage\nWe combine the data.frames in the list into one data.frame for easier handling.\n\nAdd a class column\n\n# --------------------\n# combine all data frames in the list into one data.frame\n# --------------------\n\n# You can select a object from the list by its name\nhead(splice_results_list$alternative_3_prime_splice_site)  %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodule_id\ngene_id\ngene_name\nseqid\nstrand\nlsv_id\nevent_id\ncomplex\ndenovo\nreference_exon_coord\nspliced_with\nspliced_with_coord\njunction_name\njunction_coord\nevent_size\nevent_non_changing\nevent_changing\njunction_changing\nSFPQ_K562_Control_median_psi\nSFPQ_K562_shRNA_median_psi\nSFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_non_changing\n\n\n\n\nENSG00000064961.19_3\nENSG00000064961.19\nHMG20B\nchr19\n+\nENSG00000064961.19:s:3575651-3575660\nENSG00000064961.19_3_A3_1\nFalse\nFalse\n3575651-3575660\nE2\n3576261-3576307\nProximal\n3575660-3576261\n3\nFalse\nFalse\nFalse\n0.938\n0.930\n-0.004\n0.355\n0.436\n\n\nENSG00000064961.19_3\nENSG00000064961.19\nHMG20B\nchr19\n+\nENSG00000064961.19:s:3575651-3575660\nENSG00000064961.19_3_A3_1\nFalse\nTrue\n3575651-3575660\nE2\n3576261-3576307\nDistal\n3575660-3576264\n3\nFalse\nFalse\nFalse\n0.062\n0.070\n0.004\n0.355\n0.436\n\n\nENSG00000116786.13_2\nENSG00000116786.13\nPLEKHM2\nchr1\n+\nENSG00000116786.13:s:15731192-15731257\nENSG00000116786.13_2_A3_1\nFalse\nFalse\n15731192-15731257\nE2\n15731889-15732048\nProximal\n15731257-15731889\n61\nFalse\nFalse\nFalse\n0.869\n0.894\n0.010\n0.512\n0.201\n\n\nENSG00000116786.13_2\nENSG00000116786.13\nPLEKHM2\nchr1\n+\nENSG00000116786.13:s:15731192-15731257\nENSG00000116786.13_2_A3_1\nFalse\nFalse\n15731192-15731257\nE2\n15731889-15732048\nDistal\n15731257-15731950\n61\nFalse\nFalse\nFalse\n0.131\n0.106\n-0.010\n0.512\n0.201\n\n\nENSG00000065526.13_2\nENSG00000065526.13\nSPEN\nchr1\n+\nENSG00000065526.13:s:15876202-15876711\nENSG00000065526.13_2_A3_1\nFalse\nFalse\n15876202-15876678\nE2\n15909321-15909481\nProximal\n15876678-15909321\n3\nFalse\nFalse\nFalse\n0.940\n0.935\n-0.005\n0.457\n0.270\n\n\nENSG00000065526.13_2\nENSG00000065526.13\nSPEN\nchr1\n+\nENSG00000065526.13:s:15876202-15876711\nENSG00000065526.13_2_A3_1\nFalse\nFalse\n15876202-15876678\nE2\n15909321-15909481\nDistal\n15876678-15909324\n3\nFalse\nFalse\nFalse\n0.060\n0.065\n0.005\n0.457\n0.270\n\n\n\n\n# Add a new column with the class name\n#####################################\n\n# now you can add a new column to the object that has the object name\nsplice_results_list$alternative_3_prime_splice_site &lt;- mutate(splice_results_list$alternative_3_prime_splice_site,\n                                                         class = \"alternative_3_prime_splice_site\")\n\nhead(splice_results_list$alternative_3_prime_splice_site)  %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodule_id\ngene_id\ngene_name\nseqid\nstrand\nlsv_id\nevent_id\ncomplex\ndenovo\nreference_exon_coord\nspliced_with\nspliced_with_coord\njunction_name\njunction_coord\nevent_size\nevent_non_changing\nevent_changing\njunction_changing\nSFPQ_K562_Control_median_psi\nSFPQ_K562_shRNA_median_psi\nSFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_non_changing\nclass\n\n\n\n\nENSG00000064961.19_3\nENSG00000064961.19\nHMG20B\nchr19\n+\nENSG00000064961.19:s:3575651-3575660\nENSG00000064961.19_3_A3_1\nFalse\nFalse\n3575651-3575660\nE2\n3576261-3576307\nProximal\n3575660-3576261\n3\nFalse\nFalse\nFalse\n0.938\n0.930\n-0.004\n0.355\n0.436\nalternative_3_prime_splice_site\n\n\nENSG00000064961.19_3\nENSG00000064961.19\nHMG20B\nchr19\n+\nENSG00000064961.19:s:3575651-3575660\nENSG00000064961.19_3_A3_1\nFalse\nTrue\n3575651-3575660\nE2\n3576261-3576307\nDistal\n3575660-3576264\n3\nFalse\nFalse\nFalse\n0.062\n0.070\n0.004\n0.355\n0.436\nalternative_3_prime_splice_site\n\n\nENSG00000116786.13_2\nENSG00000116786.13\nPLEKHM2\nchr1\n+\nENSG00000116786.13:s:15731192-15731257\nENSG00000116786.13_2_A3_1\nFalse\nFalse\n15731192-15731257\nE2\n15731889-15732048\nProximal\n15731257-15731889\n61\nFalse\nFalse\nFalse\n0.869\n0.894\n0.010\n0.512\n0.201\nalternative_3_prime_splice_site\n\n\nENSG00000116786.13_2\nENSG00000116786.13\nPLEKHM2\nchr1\n+\nENSG00000116786.13:s:15731192-15731257\nENSG00000116786.13_2_A3_1\nFalse\nFalse\n15731192-15731257\nE2\n15731889-15732048\nDistal\n15731257-15731950\n61\nFalse\nFalse\nFalse\n0.131\n0.106\n-0.010\n0.512\n0.201\nalternative_3_prime_splice_site\n\n\nENSG00000065526.13_2\nENSG00000065526.13\nSPEN\nchr1\n+\nENSG00000065526.13:s:15876202-15876711\nENSG00000065526.13_2_A3_1\nFalse\nFalse\n15876202-15876678\nE2\n15909321-15909481\nProximal\n15876678-15909321\n3\nFalse\nFalse\nFalse\n0.940\n0.935\n-0.005\n0.457\n0.270\nalternative_3_prime_splice_site\n\n\nENSG00000065526.13_2\nENSG00000065526.13\nSPEN\nchr1\n+\nENSG00000065526.13:s:15876202-15876711\nENSG00000065526.13_2_A3_1\nFalse\nFalse\n15876202-15876678\nE2\n15909321-15909481\nDistal\n15876678-15909324\n3\nFalse\nFalse\nFalse\n0.060\n0.065\n0.005\n0.457\n0.270\nalternative_3_prime_splice_site\n\n\n\n\n# do the same for all classes\nsplice_results_list$alternative_5_prime_splice_site &lt;- mutate(splice_results_list$alternative_5_prime_splice_site,\n                                                         class = \"alternative_5_prime_splice_site\")\nsplice_results_list$cassette_exons &lt;- mutate(splice_results_list$cassette_exons,\n                                                         class = \"cassette_exons\")\nsplice_results_list$alternative_first_exon &lt;- mutate(splice_results_list$alternative_first_exon,\n                                                         class = \"alternative_first_exon\")\nsplice_results_list$alternative_last_exon &lt;- mutate(splice_results_list$alternative_last_exon,\n                                                         class = \"alternative_last_exon\")\nsplice_results_list$mutually_exclusive_exons &lt;- mutate(splice_results_list$mutually_exclusive_exons ,\n                                                         class = \"mutually_exclusive_exons\")\nsplice_results_list$intron_retention &lt;- mutate(splice_results_list$intron_retention,\n                                               class = \"intron_retention\")\n\n\n\nSelect only the most important columns\nWe select the following columns:\n\nName of the gene in which the LSV is located\nChromosome where the gene is located\nStrand of the gene\nUnique ID of the LSV\nPSI of the control samples (median of all samples)\nPSI of the condition samples (median of all samples, condition is for example knockout or knockdown)\ndeltaPSI of condition vs control\nProbability that the change (|deltaPSI|) was \\(\\ge\\) 0.05 (change of 5% or more)\nclass of splicing event\n\n\n# select important columns\n##########################\ncolnames(splice_results_list$alternative_3_prime_splice_site)\n\n [1] \"module_id\"                                                 \n [2] \"gene_id\"                                                   \n [3] \"gene_name\"                                                 \n [4] \"seqid\"                                                     \n [5] \"strand\"                                                    \n [6] \"lsv_id\"                                                    \n [7] \"event_id\"                                                  \n [8] \"complex\"                                                   \n [9] \"denovo\"                                                    \n[10] \"reference_exon_coord\"                                      \n[11] \"spliced_with\"                                              \n[12] \"spliced_with_coord\"                                        \n[13] \"junction_name\"                                             \n[14] \"junction_coord\"                                            \n[15] \"event_size\"                                                \n[16] \"event_non_changing\"                                        \n[17] \"event_changing\"                                            \n[18] \"junction_changing\"                                         \n[19] \"SFPQ_K562_Control_median_psi\"                              \n[20] \"SFPQ_K562_shRNA_median_psi\"                                \n[21] \"SFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\"             \n[22] \"SFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\"    \n[23] \"SFPQ_K562_shRNA.SFPQ_K562_Control_probability_non_changing\"\n[24] \"class\"                                                     \n\ncols &lt;- c(\"gene_name\", \n  \"seqid\", \n  \"strand\", \n  \"lsv_id\", \n  \"complex\",\n  \"junction_coord\",\n  \"SFPQ_K562_Control_median_psi\", \n  \"SFPQ_K562_shRNA_median_psi\", \n  \"SFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\",\n  \"SFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\",\n  \"class\")\n\nIn order to do that to all objects in the list (all splicing classes), we use a for loop again.\n\nfor(i in 1:length(splice_results_list)){\n  print(names(splice_results_list[i]))\n  splice_results_list[[i]] =  select(splice_results_list[[i]], cols)\n}\n\n[1] \"alternative_3_prime_splice_site\"\n[1] \"alternative_5_prime_splice_site\"\n[1] \"cassette_exons\"\n[1] \"alternative_first_exon\"\n[1] \"alternative_last_exon\"\n[1] \"mutually_exclusive_exons\"\n[1] \"intron_retention\"\n\n\n\n\nMake one data.frame combining all classes\n\n# Combine all\nsplice_results &lt;- rbind(splice_results_list$alternative_3_prime_splice_site,\n                        splice_results_list$alternative_5_prime_splice_site,\n                        splice_results_list$cassette_exons,\n                        splice_results_list$alternative_first_exon,\n                        splice_results_list$alternative_last_exon,\n                        splice_results_list$mutually_exclusive_exons,\n                        splice_results_list$intron_retention)\nhead(splice_results) %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nSFPQ_K562_Control_median_psi\nSFPQ_K562_shRNA_median_psi\nSFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\nclass\n\n\n\n\nHMG20B\nchr19\n+\nENSG00000064961.19:s:3575651-3575660\nFalse\n3575660-3576261\n0.938\n0.930\n-0.004\n0.355\nalternative_3_prime_splice_site\n\n\nHMG20B\nchr19\n+\nENSG00000064961.19:s:3575651-3575660\nFalse\n3575660-3576264\n0.062\n0.070\n0.004\n0.355\nalternative_3_prime_splice_site\n\n\nPLEKHM2\nchr1\n+\nENSG00000116786.13:s:15731192-15731257\nFalse\n15731257-15731889\n0.869\n0.894\n0.010\n0.512\nalternative_3_prime_splice_site\n\n\nPLEKHM2\nchr1\n+\nENSG00000116786.13:s:15731192-15731257\nFalse\n15731257-15731950\n0.131\n0.106\n-0.010\n0.512\nalternative_3_prime_splice_site\n\n\nSPEN\nchr1\n+\nENSG00000065526.13:s:15876202-15876711\nFalse\n15876678-15909321\n0.940\n0.935\n-0.005\n0.457\nalternative_3_prime_splice_site\n\n\nSPEN\nchr1\n+\nENSG00000065526.13:s:15876202-15876711\nFalse\n15876678-15909324\n0.060\n0.065\n0.005\n0.457\nalternative_3_prime_splice_site\n\n\n\n\nsplice_results %&gt;% subset(lsv_id == \"ENSG00000076685.19:s:103101045-103101102\") %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nSFPQ_K562_Control_median_psi\nSFPQ_K562_shRNA_median_psi\nSFPQ_K562_shRNA.SFPQ_K562_Control_median_dpsi\nSFPQ_K562_shRNA.SFPQ_K562_Control_probability_changing\nclass\n\n\n\n\n2223\nNT5C2\nchr10\n-\nENSG00000076685.19:s:103101045-103101102\nTrue\n103100964-103101045\n0.052\n0.014\n-0.010\n0.388\nalternative_3_prime_splice_site\n\n\n2224\nNT5C2\nchr10\n-\nENSG00000076685.19:s:103101045-103101102\nTrue\n103100943-103101045\n0.056\n0.065\n0.007\n0.500\nalternative_3_prime_splice_site\n\n\n10839\nNT5C2\nchr10\n-\nENSG00000076685.19:s:103101045-103101102\nTrue\n103100019-103101045\n0.897\n0.917\n0.012\n0.540\ncassette_exons\n\n\n10840\nNT5C2\nchr10\n-\nENSG00000076685.19:s:103101045-103101102\nTrue\n103100943-103101045\n0.056\n0.065\n0.007\n0.500\ncassette_exons\n\n\n10843\nNT5C2\nchr10\n-\nENSG00000076685.19:s:103101045-103101102\nTrue\n103100019-103101045\n0.897\n0.917\n0.012\n0.540\ncassette_exons\n\n\n10844\nNT5C2\nchr10\n-\nENSG00000076685.19:s:103101045-103101102\nTrue\n103100964-103101045\n0.052\n0.014\n-0.010\n0.388\ncassette_exons\n\n\n\n\n# rename columns\ncolnames(splice_results) &lt;- cols &lt;- c(\"gene_name\", \n  \"seqid\", \n  \"strand\", \n  \"lsv_id\", \n  \"complex\",\n  \"junction_coord\",\n  \"ctrl_median_psi\", \n  \"cond_median_psi\", \n  \"dpsi\",\n  \"probability_changing\",\n  \"class\")\n\n\n# remove the list \n#remove(splice_results_list)\n\n\n\nRemoving the target LSV perspective\nIf we now look at the lsv_ids we can see, that the same lsv_id always exists once with a “:s:” and once with a “:t:” in the middle. These are the quantification for the same LSV once from the source (:s:) and once from the target (:t:) perspective (We this also in the VOILA visualisation part).\nThis information can be used in more advanced analyses. For simplicity we here only look at the source perspective and remove all rows with the target perspective.\n\n# select only rows with the source perspective (that contain :s: in te lsv_id)\nsplice_results &lt;- subset(splice_results, grepl(lsv_id, pattern = \":s:\")) \n\n\n\nRemoving duplicated LSV junctions\nIf we look at the complex events, we can see that some rows are duplicated. To remove them we look for rows that have the same lsv_id and junction_coord. We combine both to a unique_juction_id and remove duplicates with negating(!) the duplicated() function\n\n# Look at complex lsvs\nsplice_results %&gt;% \n  subset(complex==\"True\") %&gt;% # filter complex events\n  arrange(., lsv_id) %&gt;% # order by lsv_id \n  head() %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nctrl_median_psi\ncond_median_psi\ndpsi\nprobability_changing\nclass\n\n\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940955-50942031\n0.011\n0.042\n0.005\n0.297\nalternative_3_prime_splice_site\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940933-50942031\n0.643\n0.569\n-0.064\n0.773\nalternative_3_prime_splice_site\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940958-50942031\n0.020\n0.042\n0.007\n0.330\nalternative_3_prime_splice_site\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940933-50942031\n0.643\n0.569\n-0.064\n0.773\nalternative_3_prime_splice_site\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940958-50942031\n0.020\n0.042\n0.007\n0.330\nalternative_3_prime_splice_site\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940955-50942031\n0.011\n0.042\n0.005\n0.297\nalternative_3_prime_splice_site\n\n\n\n\n# remove duplicated rows\nsplice_results = splice_results %&gt;% \n  rowwise() %&gt;%\n  mutate(unique_juction_id = paste0(lsv_id, \"_\", junction_coord)) %&gt;% \n  subset(., !duplicated(unique_juction_id))\n\n# look again\nsplice_results %&gt;% \n  subset(complex==\"True\") %&gt;% # filter complex events\n  arrange(., lsv_id) %&gt;% # order by lsv_id\n  head() %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nctrl_median_psi\ncond_median_psi\ndpsi\nprobability_changing\nclass\nunique_juction_id\n\n\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940955-50942031\n0.011\n0.042\n0.005\n0.297\nalternative_3_prime_splice_site\nENSG00000000419.14:s:50942031-50943273_50940955-50942031\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940933-50942031\n0.643\n0.569\n-0.064\n0.773\nalternative_3_prime_splice_site\nENSG00000000419.14:s:50942031-50943273_50940933-50942031\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50940958-50942031\n0.020\n0.042\n0.007\n0.330\nalternative_3_prime_splice_site\nENSG00000000419.14:s:50942031-50943273_50940958-50942031\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50936262-50942031\n0.241\n0.186\n-0.047\n0.703\ncassette_exons\nENSG00000000419.14:s:50942031-50943273_50936262-50942031\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50941209-50942031\n0.082\n0.177\n0.083\n0.924\ncassette_exons\nENSG00000000419.14:s:50942031-50943273_50941209-50942031\n\n\nSCYL3\nchr1\n-\nENSG00000000457.14:s:169859041-169859212\nTrue\n169854964-169859041\n0.655\n0.582\n-0.028\n0.681\ncassette_exons\nENSG00000000457.14:s:169859041-169859212_169854964-169859041\n\n\n\n\n\n\n\nSave resulting data.frame for comparison\nHere we save the cleaned data.frame of the splicing results for the comparison in the next session.\n\nsaveRDS(splice_results, \"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SFPQ_K562.rds\")"
  },
  {
    "objectID": "global_splicing.html#number-of-detected-lsvs",
    "href": "global_splicing.html#number-of-detected-lsvs",
    "title": "Global characterisation of detected splice events",
    "section": "Number of detected LSVs",
    "text": "Number of detected LSVs\nFirst we want to know how many LSVs were detected and in how many genes these LSVs are positioned.\n\n# Number of LSVs\nsplice_results$lsv_id %&gt;% \n  unique() %&gt;% \n  length()\n\n[1] 14752\n\n# Number of splcied genes\nsplice_results$gene_name %&gt;% \n  unique() %&gt;% \n  length()\n\n[1] 7145"
  },
  {
    "objectID": "global_splicing.html#complexity-of-lsvs",
    "href": "global_splicing.html#complexity-of-lsvs",
    "title": "Global characterisation of detected splice events",
    "section": "Complexity of LSVs",
    "text": "Complexity of LSVs\nWe already learned that LSVs consist of a set of exons and a set of junctions connected to them. We call LSVs binary if they contain only two junctions and complex if they contain more than two junctions.\nYou can check how many events where complex with\n\n# number of junctions per lsv\ntable(splice_results$lsv_id) %&gt;% head()\n\n\n  ENSG00000000419.14:s:50942031-50943273 \n                                       5 \n  ENSG00000000419.14:s:50945847-50945923 \n                                       2 \nENSG00000000457.14:s:169859041-169859212 \n                                       3 \nENSG00000000457.14:s:169870255-169870357 \n                                       2 \nENSG00000000460.17:s:169798857-169798958 \n                                       2 \nENSG00000000460.17:s:169803169-169803309 \n                                       2 \n\n# number of lsvs with n junctions\nn_junctions &lt;- table(table(splice_results$lsv_id))\nn_junctions\n\n\n    2     3     4     5     6     7     8 \n12160  2068   407    94    19     3     1 \n\n\nAnd show these numbers in a bar plot:\n\nn_junctions &lt;- as.data.frame(n_junctions)\n\n# plot\nggplot(n_junctions, aes(x = Var1, y = Freq))+\n  geom_col()\n\n\n\n\n\n\n\n\nWe can see that the vast majority of LSVs contains only two junctions.\nHere are some possibilities to make the plot look nicer: - add up all LSVs with 5 or more junctions in the 5 bar - add numbers in the barchart - add axis labels - add a nice theme\n\n# Only focus the plot on 2-5junctions\n# --&gt; set all values bigger than 8 to 8\n\nn_junctions &lt;- mutate(n_junctions, Var1_plot = case_when(as.numeric(Var1) &gt;= 5 ~ 5,\n                                                         T ~ as.numeric(Var1) ))\n\nggplot(n_junctions, aes(x = Var1_plot, y = Freq))+\n  geom_col( width = 1)\n\n\n\n\n\n\n\n# some adjustments for nice plots:\n###################################\n\n# add numbers over bars\nggplot(n_junctions, aes(x = Var1_plot, y = Freq))+\n  geom_col()+\n  geom_text(data = n_junctions %&gt;% subset(Var1 %in% 1:5), \n            aes(label=Freq, x = Var1_plot, y = Freq), \n            position=position_dodge(width=0.9), vjust=0)\n\n\n\n\n\n\n\n# change axis labels\nggplot(n_junctions, aes(x = Var1_plot, y = Freq))+\n  geom_col()+\n  geom_text(data = n_junctions %&gt;% subset(Var1 %in% 1:5), \n            aes(label=Freq, x = Var1_plot, y = Freq), \n            position=position_dodge(width=0.9), vjust=0)+\n  xlab(\"Complex LSV\")+\n  ylab(\"Number of LSVs\")\n\n\n\n\n\n\n\n# cool theme\nggplot(n_junctions, aes(x = Var1_plot, y = Freq))+\n  geom_col()+\n  geom_text(data = n_junctions %&gt;% subset(Var1 %in% 1:5), \n            aes(label=Freq, x = Var1_plot, y = Freq), \n            position=position_dodge(width=0.9), vjust=0)+\n  xlab(\"Complex LSV\")+\n  ylab(\"Number of LSVs\")+\n  theme_pubr()  # try some others theme_dark(), theme_bw(), theme_minimal and chose you favorite\n\n\n\n\n\n\n\n\n\nStrength of splicing changes\nSplicing changes for each junction are indicated in the column mean_dpsi_per_lsv_junction. For a first overview about the global splicing changes, we extract the maximum deltaPSI value from each LSV and plot this information. The direction of the splicing change is ingored by using the absolut value with abs().\nWe can select the maximum value by grouping the data frame (group_by()), arranging each group by the dpsi value in descending order (arrange(), desc()) and then slicing out the first per group (slice()).\n\nhighest_junction_per_lsv &lt;- splice_results %&gt;%\n  group_by(lsv_id) %&gt;%\n  arrange(desc(abs(dpsi)), .by_group = T) %&gt;%\n  slice(1) %&gt;% \n  ungroup()\n\nhighest_junction_per_lsv %&gt;% head() %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nctrl_median_psi\ncond_median_psi\ndpsi\nprobability_changing\nclass\nunique_juction_id\n\n\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50941209-50942031\n0.082\n0.177\n0.083\n0.924\ncassette_exons\nENSG00000000419.14:s:50942031-50943273_50941209-50942031\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50945847-50945923\nFalse\n50942126-50945847\n0.126\n0.096\n-0.021\n0.522\ncassette_exons\nENSG00000000419.14:s:50945847-50945923_50942126-50945847\n\n\nSCYL3\nchr1\n-\nENSG00000000457.14:s:169859041-169859212\nTrue\n169855957-169859041\n0.043\n0.164\n0.071\n0.729\ncassette_exons\nENSG00000000457.14:s:169859041-169859212_169855957-169859041\n\n\nSCYL3\nchr1\n-\nENSG00000000457.14:s:169870255-169870357\nFalse\n169869128-169870255\n0.054\n0.072\n0.008\n0.478\nalternative_3_prime_splice_site\nENSG00000000457.14:s:169870255-169870357_169869128-169870255\n\n\nC1orf112\nchr1\n+\nENSG00000000460.17:s:169798857-169798958\nFalse\n169798958-169802621\n0.282\n0.269\n-0.010\n0.587\ncassette_exons\nENSG00000000460.17:s:169798857-169798958_169798958-169802621\n\n\nC1orf112\nchr1\n+\nENSG00000000460.17:s:169803169-169803309\nFalse\n169803309-169804075\n0.844\n0.789\n-0.029\n0.653\nalternative_3_prime_splice_site\nENSG00000000460.17:s:169803169-169803309_169803309-169804075\n\n\n\n\n\nFrom this we can easily get the number of detected LSVs\nNow that we have for each LSV the maximum deltaPSI as a column in the data.frame, we can create a histogram to get an overview about the splicing changes.\n\nggplot(data=highest_junction_per_lsv, aes(x=abs(dpsi))) +\n  geom_histogram(binwidth=.025) +\n  theme_bw() +\n  labs(x=\"Maximum deltaPSI per LSV\", y=\"Frequency\")\n\n\n\n\n\n\n\n\nWe can see for both comparisons that the majority of LSVs does not show strong changes. As the first bars are so high we can not see really what is happening beyond 0.1. One way to have a better view in this region is to log10-transform the y-axis using the scale_y_log10() function of the ggplot2 package.\n\nggplot(data=highest_junction_per_lsv, aes(x=abs(dpsi))) +\n  geom_histogram(binwidth=.025) +\n  theme_bw() +\n  labs(x=\"Maximum deltaPSI per LSV\", y=\"Frequency\")+\n  scale_y_log10()\n\nA second alternative offers the xlim() function of the ggplot2 package, which automatically filters for maxDeltaPSI values between 0.075 and 0.5. You can change the range depending what you see in your data.\n\nggplot(data=highest_junction_per_lsv, aes(x=abs(dpsi))) +\n  geom_histogram(binwidth=.025) +\n  theme_bw() +\n  labs(x=\"Maximum deltaPSI per LSV\", y=\"Frequency\")+\n  theme_bw() +\n  xlim(0.075,0.5) \n\n\n\n\n\n\n\n\n\n\nSignificance of splicing changes\nThe probability we can see in the column probability_changing is based on a deltaPSI threshold that was defined in the voila tsv step. I used here a threshold of 0.05. If we see a probability of 0.9 for a junction this means that there is a 90% probability that the deltaPSI value of the junction was greater than 0.05.\nWe could also plot a histogram for the probabilities, but what is more interesting is the relationship between the maximal deltaPSI and maximal probability of the LSVs. Note that typically the maximal deltaPSI and maximal probability belong to the same junction.\nWe now create a scatter plot in which we plot for each LSV the maximal deltaPSI against the maximal probability. With geom_hline() from the ggplot2 package we can also plot a probability treshold of 0.9 (which we typically use), which will be used to define regulated LSVs later. Note that in geom_point() we use the alpha parameter that controls the transparency of the points. If we set it to a lower value, we can better see where a lot of points are plotted on top of each other.\n\n  ggplot(highest_junction_per_lsv, aes(x=abs(dpsi), y=probability_changing)) +\n    geom_point(alpha=.25) +\n    geom_hline(yintercept=0.9, col=\"red\", linetype=\"dashed\") +\n    theme_bw() +\n    labs(x=\"Maximum deltaPSI per LSV\", y=\"Maximum probability per LSV\")\n\n\n\n\n\n\n\n\nWe can see that that in the K562 comparison we have more LSVs above our probability threshold, which indicates that in this comparison we have more significantly regulated LSVs."
  },
  {
    "objectID": "global_splicing.html#regulated-lsvs",
    "href": "global_splicing.html#regulated-lsvs",
    "title": "Global characterisation of detected splice events",
    "section": "Regulated LSVs",
    "text": "Regulated LSVs\nNow it is time to determine the significantly changing LSVs.\n\nNumber and fraction of regulated LSVs\nWe check for each of the LSVs if the maximal probability is \\(\\ge\\) our threshold of 0.9 and store this information with TRUE or FALSE in a new column called sign.\n\n# add a column sig that tells us whether the change was significant\nhighest_junction_per_lsv$sign &lt;- highest_junction_per_lsv$probability_changing &gt;= 0.9\nhead(highest_junction_per_lsv) %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nctrl_median_psi\ncond_median_psi\ndpsi\nprobability_changing\nclass\nunique_juction_id\nsign\n\n\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50942031-50943273\nTrue\n50941209-50942031\n0.082\n0.177\n0.083\n0.924\ncassette_exons\nENSG00000000419.14:s:50942031-50943273_50941209-50942031\nTRUE\n\n\nDPM1\nchr20\n-\nENSG00000000419.14:s:50945847-50945923\nFalse\n50942126-50945847\n0.126\n0.096\n-0.021\n0.522\ncassette_exons\nENSG00000000419.14:s:50945847-50945923_50942126-50945847\nFALSE\n\n\nSCYL3\nchr1\n-\nENSG00000000457.14:s:169859041-169859212\nTrue\n169855957-169859041\n0.043\n0.164\n0.071\n0.729\ncassette_exons\nENSG00000000457.14:s:169859041-169859212_169855957-169859041\nFALSE\n\n\nSCYL3\nchr1\n-\nENSG00000000457.14:s:169870255-169870357\nFalse\n169869128-169870255\n0.054\n0.072\n0.008\n0.478\nalternative_3_prime_splice_site\nENSG00000000457.14:s:169870255-169870357_169869128-169870255\nFALSE\n\n\nC1orf112\nchr1\n+\nENSG00000000460.17:s:169798857-169798958\nFalse\n169798958-169802621\n0.282\n0.269\n-0.010\n0.587\ncassette_exons\nENSG00000000460.17:s:169798857-169798958_169798958-169802621\nFALSE\n\n\nC1orf112\nchr1\n+\nENSG00000000460.17:s:169803169-169803309\nFalse\n169803309-169804075\n0.844\n0.789\n-0.029\n0.653\nalternative_3_prime_splice_site\nENSG00000000460.17:s:169803169-169803309_169803309-169804075\nFALSE\n\n\n\n\n# Look at how many are significant and how many not\ntable(highest_junction_per_lsv$sign)  %&gt;% kable()\n\n\n\n\nVar1\nFreq\n\n\n\n\nFALSE\n13191\n\n\nTRUE\n1561\n\n\n\n\n# calculate percentages\nt &lt;- table(highest_junction_per_lsv$sign) \n\n(t/sum(t)) %&gt;% kable()\n\n\n\n\nVar1\nFreq\n\n\n\n\nFALSE\n0.8941838\n\n\nTRUE\n0.1058162\n\n\n\n\nsaveRDS(highest_junction_per_lsv, \"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SFPQ_K562_highest_junction.rds\")\n\nWe can also plot this information with a stacked bar chart.We add the coord_cartesian() function of ggplot2 to zoom-in the y-axis (0 to 2000), as we do not have so many regulated events. You can adjust the ylim input if you want.\n\ngg_df &lt;- table(highest_junction_per_lsv$sign) %&gt;% \n  as.data.frame()\n\nggplot(gg_df, aes( x = 1, y = Freq, fill=Var1))+\n  geom_col() +\n  #coord_cartesian(ylim=(c(0,2000))) +\n  labs(x=\"Comparison\", y=\"Frequency\") +\n  theme_bw()+\n  geom_text(aes(x = 1, label=Freq), vjust=2, col = \"white\")\n\n\n\n\n\n\n\n\nIn this plot we can see the absolute number of significant LSVs among all LSVs. Next to the absolute number we could also plot the fraction of significant LSVs among all LSVs. Fraction is similar to percentage when you multiply it by 100. This makes the comparison between comparisons with different number of LSVs more fair.\n\nggplot(gg_df, aes( x = 1, y = Freq, fill=Var1))+\n  geom_col(position = \"fill\") +\n  labs(x=\"Comparison\", y=\"Frequency\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n\n\nColour significant changes\nWe can also color the significant LSVs in the scatterplot from above:\n\n  ggplot(highest_junction_per_lsv, aes(x=abs(dpsi), y=probability_changing, color = sign)) +\n    geom_point(alpha=.25) +\n    geom_hline(yintercept=0.9, col=\"red\", linetype=\"dashed\") +\n    theme_bw() +\n  scale_color_manual(values = c(\"black\", \"blue\"))+\n    labs(x=\"Maximum deltaPSI per LSV\", y=\"Maximum probability per LSV\")\n\n\n\n\n\n\n\n\n\n\nTop 10 spliced LSVs\nIf we want to know the LSVs with the highest changes. We can arrange() the data.frame by the dpsi values and look at the top 10.\n\ntop10 &lt;- highest_junction_per_lsv %&gt;% \n  arrange(desc(abs(dpsi))) %&gt;% \n  head(n = 10)\n\ntop10 %&gt;% kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene_name\nseqid\nstrand\nlsv_id\ncomplex\njunction_coord\nctrl_median_psi\ncond_median_psi\ndpsi\nprobability_changing\nclass\nunique_juction_id\nsign\n\n\n\n\nENSG00000290385\nchr1\n-\nENSG00000290385.1:s:504980-505103\nTrue\n502955-504980\n0.184\n0.833\n0.649\n0.999\nmutually_exclusive_exons\nENSG00000290385.1:s:504980-505103_502955-504980\nTRUE\n\n\nFRG1DP\nchr20\n+\nENSG00000282870.1:s:29091594-29091719\nFalse\n29091719-29092501\n0.665\n0.022\n-0.640\n1.000\nalternative_last_exon\nENSG00000282870.1:s:29091594-29091719_29091719-29092501\nTRUE\n\n\nARVCF\nchr22\n-\nENSG00000099889.14:s:19971886-19971971\nTrue\n19970743-19971886\n0.643\n0.099\n-0.565\n1.000\ncassette_exons\nENSG00000099889.14:s:19971886-19971971_19970743-19971886\nTRUE\n\n\nPCSK6\nchr15\n-\nENSG00000140479.18:s:101365785-101366332\nTrue\n101332031-101366196\n0.917\n0.368\n-0.547\n1.000\nalternative_last_exon\nENSG00000140479.18:s:101365785-101366332_101332031-101366196\nTRUE\n\n\nMAPK8\nchr10\n+\nENSG00000107643.17:s:48306639-48306821\nTrue\n48306821-48401612\n0.773\n0.236\n-0.528\n0.998\ncassette_exons\nENSG00000107643.17:s:48306639-48306821_48306821-48401612\nTRUE\n\n\nFAM172A\nchr5\n-\nENSG00000113391.19:s:94111511-94111699\nFalse\n94053227-94111511\n0.905\n0.381\n-0.528\n0.997\ncassette_exons\nENSG00000113391.19:s:94111511-94111699_94053227-94111511\nTRUE\n\n\nDHX34\nchr19\n+\nENSG00000134815.19:s:47376443-47376560\nFalse\n47376560-47377100\n0.859\n0.363\n-0.522\n0.996\ncassette_exons\nENSG00000134815.19:s:47376443-47376560_47376560-47377100\nTRUE\n\n\nCCDC169\nchr13\n-\nENSG00000242715.8:s:36283469-36283509\nTrue\n36281260-36283469\n0.177\n0.739\n0.516\n0.985\nalternative_last_exon\nENSG00000242715.8:s:36283469-36283509_36281260-36283469\nTRUE\n\n\nCPQ\nchr8\n+\nENSG00000104324.16:s:97029403-97029494\nFalse\n97029494-97055529\n0.542\n0.026\n-0.511\n0.999\nalternative_last_exon\nENSG00000104324.16:s:97029403-97029494_97029494-97055529\nTRUE\n\n\nZSCAN25\nchr7\n+\nENSG00000197037.11:s:99619550-99619997\nFalse\n99619997-99621373\n0.608\n0.104\n-0.507\n1.000\nalternative_5_prime_splice_site\nENSG00000197037.11:s:99619550-99619997_99619997-99621373\nTRUE"
  },
  {
    "objectID": "DGE.html",
    "href": "DGE.html",
    "title": "Differential gene expression analysis",
    "section": "",
    "text": "Coming soon!"
  },
  {
    "objectID": "voila_gui.html",
    "href": "voila_gui.html",
    "title": "Visualising splice events",
    "section": "",
    "text": "You received the results of the MAJIQ analysis from your data set. First we want to visualize some of the results you obtained. For this we use two methods:"
  },
  {
    "objectID": "voila_gui.html#open-your-results-in-the-voila-gui",
    "href": "voila_gui.html#open-your-results-in-the-voila-gui",
    "title": "Visualising splice events",
    "section": "Open your results in the VOILA GUI",
    "text": "Open your results in the VOILA GUI\nTo visualize your splicing results, navigate to the folder where the VOILA GUI is located and double click on voila_app (MAC OS and Linux) or Voila App.lnk (Windows).\nThe Voila Launcher should open:\n\nEnter the path to the folder containing the VOILA-File of your first comparison (.voila), the path to the splicegraph.sql and a port number (any number) and click “Voila View”. If you do it the first time, it may take up to 5 minutes (the program is indexing a lot of stuff). If you run it a second time it will only take some seconds.\nThe GUI might open automatically. If not open a browser window and enter “localhost:5005” (or your defined port number) into the address bar (red arrow).\n\nYou can do the same with a different port number for the second comparison."
  },
  {
    "objectID": "voila_gui.html#adjusting-filters",
    "href": "voila_gui.html#adjusting-filters",
    "title": "Visualising splice events",
    "section": "Adjusting filters",
    "text": "Adjusting filters\nYou can now see the results of the MAJIQ splice analysis. On the top of the page, there are several options to filter your results:\n\nOn the top are options for filtering for specific classes of splice events ( e.g. alternative 5’ or 3’ splice sites, Exon Skipping or binary events).\nBelow this you can apply a deltaPSI and Confidence Threshold filter.\n\n\nBy default the two filters are set to 0.2 (deltaPSI) and 0.95 (Confidence Threshold) filter, which means that only LSVs are shown that have at least one junction that has a 95% probability changing and a |deltaPSI| value ≥ 0.2 (20%).\nDepending on your data set, you might see very few splicing events with these filters. In this case turn down the filters to a deltaPSI of 0.05 and a Confidence Threshold of 0.9."
  },
  {
    "objectID": "voila_gui.html#overview-of-regulated-lsvs",
    "href": "voila_gui.html#overview-of-regulated-lsvs",
    "title": "Visualising splice events",
    "section": "Overview of regulated LSVs",
    "text": "Overview of regulated LSVs\nBelow the filters you can see a table with 5 columns. The first column tells us the name of the gene in which the LSV is located and the second column specifies a unique ID for the LSV. The last column offers a UCSC link (not important for us).\n\nThe third column depicts a simplified scheme of the LSV: The yellow box is the source or target exon of the LSV and the number in it tell you that it is the nth exon in the gene. The grey boxes are all other exons connected to the source or target exon and the colored lines stand for the splice-junctions. Intron retention are denoted by colored smaller boxes between two exons. Alternative 3’ or 5’ splice sites are depicted as doted lines inside the exons. An LSV with only two junctions is called binary LSV, LSVs with more than two junctions is called complex LSV.\n{fig-visualisation}\nThe fourth column the deltaPSI values of the involved junctions. The color of the bar corresponds to the color of the junction in the LSV scheme. If you click on a plot in the fourth column, the bar plot changes into a violin plot giving us more detailed information."
  },
  {
    "objectID": "voila_gui.html#genewise-details-on-lsvs",
    "href": "voila_gui.html#genewise-details-on-lsvs",
    "title": "Visualising splice events",
    "section": "Genewise details on LSVs",
    "text": "Genewise details on LSVs\nAs an example we click on the plot of the LSV located in the TNRC6A gene (from a comparison between an HNRNPH1 knockdown and a corresponding control sample).\n\nIf we now have a closer look on this exon skipping event, we can see that the red junction supports the inclusion of the inner exon, while the blue junction skips it. In the violin plot we can see that upon knockdown of HNRNPH1 the usage of the red junction is upregulated by 48.1% and the usage of the blue junction is downregulated by 48.1%.\nTo get more details about this specific LSV you can click on the gene name. \nIn the upper part we can see two splicegraphs for TNR6CA. The upper one belongs to the control experiment and the lower one to the knockdown experiment. The numbers at the splice junctions are indicating the number of reads supporting the junction. This is the sum over the replicates. The splicegraph is interactive, meaning you can go with the mouse on the splice junctions or exons and get information about the genomic coordinates and the length.\nIn the lower part you can see all detected LSVs of the gene. You can click the Highlight checkbox to highlight the LSV in the splicegraph. In contrast to the previous page, we now also have bar plots showing the PSI values in the control and knockdown experiments (column 4 and 6). Reminder dPSI = PSI(condition) - PSI(control). You can also click these to get a violin plot.\nLet’s have a look on the strongly regulated exon skipping event in this gene (red arrow). As we can see, this LSV is from a source exon perspective as only junctions going out of this exon are quantified. If you look closely, you can see that there is a second LSV from a target exon perspective supporting the same event (green arrow). As we can see from the deltaPSI values the two LSVs are in agreement about the regulation. The upper LSV claims that the first inclusion junction is going up by 48.1% and the lower LSV is showing an upregulation of the second inclusion junction by 53%. Such small fluctuations are expected.\n\nYou now can continue to screen for interesting events in your data. It might be helpful to check in the literature for alternative splicing events that are known to be regulated by your protein."
  },
  {
    "objectID": "comparison_two_datasets.html",
    "href": "comparison_two_datasets.html",
    "title": "Comparison of alternative splicing in two data sets",
    "section": "",
    "text": "Now we want to compare the alternative splicing found in the two analysed data sets."
  },
  {
    "objectID": "comparison_two_datasets.html#required-packages",
    "href": "comparison_two_datasets.html#required-packages",
    "title": "Comparison of alternative splicing in two data sets",
    "section": "Required packages",
    "text": "Required packages\n\nlibrary(dplyr) # to easily handle data.frames \nlibrary(knitr) # beautiful tables\n\nlibrary(ggplot2) # nice plots\nlibrary(ggpubr) # for even more nice plots\nlibrary(eulerr) # for venn diagrams\nlibrary(ggpointdensity)"
  },
  {
    "objectID": "comparison_two_datasets.html#load-splicing-results",
    "href": "comparison_two_datasets.html#load-splicing-results",
    "title": "Comparison of alternative splicing in two data sets",
    "section": "Load splicing results",
    "text": "Load splicing results\nFirst we load the data.frames from the global analysis of both data sets.\n\n# data.frames containing all junctions per LSV\nHepG2 &lt;- readRDS(\"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SFPQ_HepG2.rds\")\nK562 &lt;- readRDS(\"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SFPQ_K562.rds\")\n\n# data.frames containing the highest junction per LSV\nHepG2_highest_junction &lt;- readRDS(\"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SFPQ_HepG2_highest_junction.rds\")\nK562_highest_junction &lt;- readRDS(\"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SFPQ_K562_highest_junction.rds\")"
  },
  {
    "objectID": "comparison_two_datasets.html#comparison-of-the-dpsi-of-the-strongest-regulated-junction",
    "href": "comparison_two_datasets.html#comparison-of-the-dpsi-of-the-strongest-regulated-junction",
    "title": "Comparison of alternative splicing in two data sets",
    "section": "Comparison of the dpsi of the strongest regulated junction",
    "text": "Comparison of the dpsi of the strongest regulated junction\nNow we combine both data sets with all junctions per LSV into one data set with double the number of columns. The columns get the ending .HepG2 or .K562 to distingish which values come from which data set.\nWe then remove junctions that were only detected in one of the two data sets. And again select the highest junction per LSV.\n\ncombined_lsvs &lt;- full_join(HepG2, K562, by = c(\"lsv_id\", \"junction_coord\"), suffix = c(\".HepG2\", \".K562\"))\ncombined_lsvs\n\n# A tibble: 41,192 × 22\n# Rowwise: \n   gene_name.HepG2 seqid.HepG2 strand.HepG2 lsv_id  complex.HepG2 junction_coord\n   &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;         \n 1 CHCHD6          chr3        +            ENSG00… False         126733222-126…\n 2 CHCHD6          chr3        +            ENSG00… False         126733222-126…\n 3 ZNF181          chr19       +            ENSG00… False         34739268-3473…\n 4 ZNF181          chr19       +            ENSG00… False         34739268-3473…\n 5 NT5C2           chr10       -            ENSG00… True          103100964-103…\n 6 NT5C2           chr10       -            ENSG00… True          103100943-103…\n 7 PDCD11          chr10       +            ENSG00… False         103439868-103…\n 8 PDCD11          chr10       +            ENSG00… False         103439868-103…\n 9 PDCD11          chr10       +            ENSG00… False         103441975-103…\n10 PDCD11          chr10       +            ENSG00… False         103441975-103…\n# ℹ 41,182 more rows\n# ℹ 16 more variables: ctrl_median_psi.HepG2 &lt;dbl&gt;,\n#   cond_median_psi.HepG2 &lt;dbl&gt;, dpsi.HepG2 &lt;dbl&gt;,\n#   probability_changing.HepG2 &lt;dbl&gt;, class.HepG2 &lt;chr&gt;,\n#   unique_juction_id.HepG2 &lt;chr&gt;, gene_name.K562 &lt;chr&gt;, seqid.K562 &lt;chr&gt;,\n#   strand.K562 &lt;chr&gt;, complex.K562 &lt;chr&gt;, ctrl_median_psi.K562 &lt;dbl&gt;,\n#   cond_median_psi.K562 &lt;dbl&gt;, dpsi.K562 &lt;dbl&gt;, …\n\n# remove junction that are only in one data set\ncombined_lsvs &lt;- combined_lsvs %&gt;% \n  subset(!is.na(gene_name.HepG2)) %&gt;% \n  subset(!is.na(gene_name.K562))\n\n# select highest lsv\ncombined_lsvs &lt;- combined_lsvs %&gt;% \n  mutate(max_cond = max(dpsi.HepG2, dpsi.K562)) %&gt;%\n  group_by(lsv_id) %&gt;%\n  arrange(max_cond, .by_group = T) %&gt;%\n  slice(1)\n\nWe can now use this data.frame to plot the dpsi values of both data sets against each other.\n\n# basic plot\nggplot(combined_lsvs, aes(x = dpsi.HepG2, y = dpsi.K562))+\n  geom_point()\n\n\n\n\n\n\n\n# plot with lines for 0\n# the axis end are determined with coord_catesian\nggplot(combined_lsvs, aes(x = dpsi.HepG2, y = dpsi.K562))+\n  geom_point()+\n  geom_hline(yintercept = 0)+\n  geom_vline(xintercept = 0)+\n  coord_cartesian(xlim = c(-1,1), ylim = c(-1,1))+\n  theme_bw()\n\n\n\n\n\n\n\n# using a point_density to see were most points are located\nggplot(combined_lsvs, aes(x = dpsi.HepG2, y = dpsi.K562))+\n  ggpointdensity::geom_pointdensity()+\n  geom_hline(yintercept = 0)+\n  geom_vline(xintercept = 0)+\n  coord_cartesian(xlim = c(-1,1), ylim = c(-1,1))+\n  theme_bw()\n\n\n\n\n\n\n\n# mark dpsis significant in both data sets\ncombined_lsvs &lt;- combined_lsvs %&gt;% \n  mutate( both_sign = (probability_changing.HepG2 &gt; 0.9) & (probability_changing.K562 &gt; 0.9))\n\nsig_combined_lsvs &lt;- combined_lsvs %&gt;% subset(both_sign == TRUE)\n\nggplot(combined_lsvs, aes(x = dpsi.HepG2, y = dpsi.K562))+\n  geom_point()+\n  geom_point(data = sig_combined_lsvs, aes(x = dpsi.HepG2, y = dpsi.K562), color = \"blue\")+\n  geom_hline(yintercept = 0)+\n  geom_vline(xintercept = 0)+\n  coord_cartesian(xlim = c(-1,1), ylim = c(-1,1))+\n  theme_bw()\n\n\n\n\n\n\n\n# plot only dpsis significant in both data sets\nggplot(sig_combined_lsvs, aes(x = dpsi.HepG2, y = dpsi.K562))+\n  geom_point()+\n  geom_hline(yintercept = 0)+\n  geom_vline(xintercept = 0)+\n  coord_cartesian(xlim = c(-1,1), ylim = c(-1,1))+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nVenn diagram of regulated LSVs between the comparisons\nNow that we have seen that there is a substantial amount of regulated LSVs in the two comparisons, we want to find out how many of them are shared between the two comparisons.\nWe first extract for both data sets the LSV identifiers of the significant LSVs.\n\ncombined_lsvs_sign_in_one &lt;- combined_lsvs %&gt;%\n  subset((probability_changing.HepG2 &gt; 0.9) | (probability_changing.K562 &gt; 0.9))\n\nNext, we make a venn diagramm using the eulerr package. For this we first collect all LSV IDs of LSVs that are significant in at least one of the data sets. Then we create a data frame with the information which of the LSVs was significant in which data set.\nWe can then use this data frame to caluclate and plot the venn diagramm. In the diagram the area in the circles is proporitional to the number of lsvs in each circle.\n\noverlaps &lt;- data.frame( \"HepG2\" = combined_lsvs_sign_in_one$probability_changing.HepG2 &gt; 0.9,\n                         \"K562\" = combined_lsvs_sign_in_one$probability_changing.K562 &gt; 0.9 )\nhead(overlaps)\n\n  HepG2  K562\n1  TRUE FALSE\n2  TRUE FALSE\n3  TRUE FALSE\n4 FALSE  TRUE\n5  TRUE FALSE\n6  TRUE FALSE\n\nvenn &lt;- eulerr::euler(overlaps)\nplot(venn, quantities = TRUE, fontface = 1)\n\n\n\n\n\n\n\n\nHere we can see only a small number of LSVs is regulated in both data sets, while the vast majority is only regulated in only one of the two comparisons.\n\n\nShared and opposite regulation between the comparisons\nSo far, we know that there is a small set of shared significantly regulated LSVs between the two comparison. But what we do not know is whether the LSVs show the same regulation in the two comparisons.\n\nsig_combined_lsvs &lt;- sig_combined_lsvs %&gt;%\n  mutate(comparison = case_when( (dpsi.HepG2 &gt; 0) & (dpsi.K562 &gt; 0) ~ \"both up\",\n                                 (dpsi.HepG2 &lt; 0) & (dpsi.K562 &lt; 0) ~ \"both down\",\n                                 T ~ \"opposite regulation\"),\n         )\n\ntable(sig_combined_lsvs$comparison) %&gt;% kable\n\n\n\n\nVar1\nFreq\n\n\n\n\nboth down\n138\n\n\nopposite regulation\n14\n\n\n\n\n\nWe can also plot this result in a barchart.\n\ngg_df &lt;- table(sig_combined_lsvs$comparison) %&gt;% \n  as.data.frame()\n\nggplot(gg_df, aes( x = 1, y = Freq, fill=Var1))+\n  geom_col() +\n  #coord_cartesian(ylim=(c(0,2000))) +\n  labs(x=\"\", y=\"Number of shared significant LSVs\") +\n  theme_classic()+\n  geom_text(aes(x = 1, label=Freq), vjust=2, col = \"white\")+\n  labs(fill = \"Direction of regulation \\n in the two data sets\")\n\n\n\n\n\n\n\n\nThe most interesting targets migh be the ones with shared regulation. Lets look at the top 20.\n\nsig_combined_lsvs %&gt;%\n  subset(comparison != \"opposite regulation\") %&gt;%\n  arrange(desc(max(dpsi.HepG2, dpsi.K562))) %&gt;%\n  head(n=20)\n\n# A tibble: 20 × 25\n# Groups:   lsv_id [20]\n   gene_name.HepG2 seqid.HepG2 strand.HepG2 lsv_id  complex.HepG2 junction_coord\n   &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;         \n 1 RHBDD2          chr7        +            ENSG00… False         75879260-7588…\n 2 CDK11A          chr1        -            ENSG00… False         1704655-17049…\n 3 AKAP8L          chr19       -            ENSG00… True          15397855-1539…\n 4 NCAPH2          chr22       +            ENSG00… True          50519320-5052…\n 5 PHKA2           chrX        -            ENSG00… False         18948826-1895…\n 6 ZC3H11A         chr1        +            ENSG00… True          203795794-203…\n 7 YBX3            chr12       -            ENSG00… True          10704148-1071…\n 8 GPBP1           chr5        +            ENSG00… False         57236032-5724…\n 9 KARS1           chr16       -            ENSG00… False         75641723-7564…\n10 PDIA5           chr3        +            ENSG00… False         123124343-123…\n11 MTHFD2          chr2        +            ENSG00… True          74198742-7420…\n12 NFYC            chr1        +            ENSG00… False         40769415-4077…\n13 PPP2R5C         chr14       +            ENSG00… True          101912473-101…\n14 PCM1            chr8        +            ENSG00… True          17972687-1798…\n15 EPB41L2         chr6        -            ENSG00… False         130869944-130…\n16 MRPL22          chr5        +            ENSG00… False         154941265-154…\n17 AGBL5           chr2        +            ENSG00… False         27069707-2707…\n18 HUWE1           chrX        -            ENSG00… True          53542539-5354…\n19 UIMC1           chr5        -            ENSG00… False         176968755-176…\n20 ANKRD10         chr13       -            ENSG00… True          110905234-110…\n# ℹ 19 more variables: ctrl_median_psi.HepG2 &lt;dbl&gt;,\n#   cond_median_psi.HepG2 &lt;dbl&gt;, dpsi.HepG2 &lt;dbl&gt;,\n#   probability_changing.HepG2 &lt;dbl&gt;, class.HepG2 &lt;chr&gt;,\n#   unique_juction_id.HepG2 &lt;chr&gt;, gene_name.K562 &lt;chr&gt;, seqid.K562 &lt;chr&gt;,\n#   strand.K562 &lt;chr&gt;, complex.K562 &lt;chr&gt;, ctrl_median_psi.K562 &lt;dbl&gt;,\n#   cond_median_psi.K562 &lt;dbl&gt;, dpsi.K562 &lt;dbl&gt;,\n#   probability_changing.K562 &lt;dbl&gt;, class.K562 &lt;chr&gt;, …"
  },
  {
    "objectID": "setting_into_functional_context.html",
    "href": "setting_into_functional_context.html",
    "title": "How alternative splicing can influence the encoded protein",
    "section": "",
    "text": "In the final section we want to identify some examples for LSVs with an impact on the resulting protein or expression levels.\nWe can look at the top 20 LSVs regulated in both data sets that we identified in the “Comparison of data sets” part and search for some targets with an interesting effect."
  },
  {
    "objectID": "setting_into_functional_context.html#mapt",
    "href": "setting_into_functional_context.html#mapt",
    "title": "How alternative splicing can influence the encoded protein",
    "section": "MAPT",
    "text": "MAPT\nThe first one is a cassette exon of MAPT (microtubule associated protein tau), which had a deltaPSI of 0.07378649 (7% more incusion in the HNRNPH1 knockdown).\nA look on the vastDB entry of the event shows in the “Protein Impact” section that the inclusion of the exon produces an alternative protein isoforms that carries four instead of three microtubule-binding domains.\n\n\n\n\n\n\n\n\n\nA closer look on the provided publications reveals that the ratio of isoforms containing and lacking the cassette exon is associated to the pathogenesis of several neurodegenerative disorders. This in turn also reveals that HNRNPH1 might be an interesting clinical target as it either directly or indirectly (we do not know this) regulates the inclusion of the cassette exon As the deltaPSI is increasing in the knockdown it likely functions as a repressor."
  },
  {
    "objectID": "setting_into_functional_context.html#sat1",
    "href": "setting_into_functional_context.html#sat1",
    "title": "How alternative splicing can influence the encoded protein",
    "section": "SAT1",
    "text": "SAT1\nThe second example is a cassette exon of SAT1 (spermidine/spermine N1-acetyltransferase 1), which had a deltaPSI of 0.06929477 (~7% more inclusion in the HNRNPH1 knockdown).\nA closer look on the vastDB entry for this event shows in the “Protein Impact” section that the inclusion of the exon disrupts the ORF, meaning that the inclusion isoform is not encoding for a functional protein.\n\nknitr::include_graphics(\"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SAT1-1.png\")\n\n\n\n\n\n\n\n\nWhen further checking the “Functional annotations” section, we can see that the isoform including the cassette exon is called SSATX and is proposed to function as a long non-coding RNA that likely acts as a tumor suppressor (first publication). In addition we can see that that the exon was identified as a poison cassette exon (second publication), which might explain the downregulation I obsered for the SAT1 gene that co-occured with the increased inclusion of the exon. The latter information indicates that HNRNPH1 might regulate the inclusion of this poison exon (as a repressor as the deltaPSI is positive in the knockdown) and therefore regulates SAT1 expression levels.\n\nknitr::include_graphics(\"/Users/melinaklostermann/Documents/projects/students/majiq-course/spezi_scripts_website/example_data/SAT1-2.png\")"
  },
  {
    "objectID": "tasks.html",
    "href": "tasks.html",
    "title": "Tasks",
    "section": "",
    "text": "Please do the following tasks always after the corresponding session. We will look at your results and problems that occurred always in the beginning of the next session.\nAt the end of the course make a protocol of all your splicing analyses in form of a quarto or rmarkdown report (.qmd/.rmd) and render it to pdf or html. Include all tasks below in the protocol.\n\nTasks for part 1 - Visualisation\nInstructions for screening AS events in the VOILA GUI and verification via Sashimi Plots in IGV can be found in part1_GUI_and_SashimiPlots.pdf.\n\nFor one of your comparisons search for binary LSVs with |deltaPSI| &gt; 0.1 and Confidence Threshold &gt; 0.9. If you can’t find events lower the deltaPSI threshold. The screenshots should include the Gene Name, the LSV ID, the LSV Schema and the violin plot of the dPSI values.\n\n\nTake a screenshot of 1 LSV representing an exon skipping event.\nTake a screenshot of 1 LSV representing an intron retention event.\nTake a screenshot of 1 LSV representing an alternative 5’ splice site event.\nTake a screenshot of 1 LSV representing an alternative 3’ splice site event.\n\n\nTake for each of the five LSVs also screenshots for your other data set (e.g. your other cell line). You can use the LSV identifier to find them. If you can’t find the same events lower the deltaPSI and confidence threshold. You can lower both thresholds to 0 to see all detected LSVs. If you still cannot find them use take screenshots of other events.\nCompare the regulation of the five LSVs between the two comparisons.\nTake one of your five LSVs and create a sashimi plot including all of your comparisons in IGV.\n\n\nYou need to load the BAM-Files into IGV and navigate to the region where the LSV is located. It is sufficient if you use the BAM-File of one replicate per condition.\nIf the BAM-Files are too huge for your computer subset them in Galaxy to the chromosome on which the LSV is located.\n\n\nDoes the sashimi plot confirm what you have seen in the VOILA GUI?\n\n\n\nTasks for part 2 - Analyzing AS at the level of LSVs\n\nRepeat or revisit the functions in the”useful R” section. (This part does not have to be included in the proctocol in the end.)\nAnalyse both of you data sets following the steps of the “Global analysis” section.\nHow many LSVs are detected in each data set? How many are significantly regulated?\nWhat are the top regulated LSVs in each data set?\nDo the data sets have a similar depth? (Are the numbers of detected and regukated LSVS similar?)\nWhat is the most common splicing class for your protein? Do a small literature research on the protein, that was knocked down / knocked out in you data set. Which types of splicing would you expect? Is this also what the data shows?\n\n\n\nTasks for part 3 - Analyzing AS at the level of AS events\nCompare the splicing in both your data sets using steps from the “Comparison of data sets” section."
  },
  {
    "objectID": "data_processing_galaxy.html",
    "href": "data_processing_galaxy.html",
    "title": "Processing",
    "section": "",
    "text": "Coming soon!"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Spezialisierungspraktikum RNA Biology",
    "section": "",
    "text": "On the following pages you can find the course materials for the Spezialisierungspraktikum RNA Biology."
  },
  {
    "objectID": "index.html#in-this-praktikum-we-look-at-the-following-topics",
    "href": "index.html#in-this-praktikum-we-look-at-the-following-topics",
    "title": "Spezialisierungspraktikum RNA Biology",
    "section": "In this Praktikum we look at the following topics:",
    "text": "In this Praktikum we look at the following topics:\n\nProcessing of RNAseq data\nDifferential Gene Expression Analysis\nDifferential analysis of local splice variants"
  },
  {
    "objectID": "index.html#about-us",
    "href": "index.html#about-us",
    "title": "Spezialisierungspraktikum RNA Biology",
    "section": "About us",
    "text": "About us\nZarnack group for Computational RNA Biology, Goethe Universität Frankfurt\nAutors: Melina Klostermann, Mario Keller, Kathi Zarnack\nVisit us on our webpage or on GitHub."
  },
  {
    "objectID": "useful_R.html",
    "href": "useful_R.html",
    "title": "Some useful R",
    "section": "",
    "text": "Before we start with the splicing analysis in R I want to introduce some important functions and operators that will help us to process the splicing output.\nlibrary(knitr)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union"
  },
  {
    "objectID": "useful_R.html#the-pipe-operator",
    "href": "useful_R.html#the-pipe-operator",
    "title": "Some useful R",
    "section": "The pipe operator %>%",
    "text": "The pipe operator %&gt;%\nLet’s start with the %&gt;% operator. This operator allows the piping of a function’s output to another function, where it is used as input.\nAssume we have a vector with decimal numbers and want to round them to integers and subsequently calculate the sum. One way to do this is the following.\n\ndecimals &lt;- c(2.5, 1.2, 3.6, 4.1, 4.6, 7.3, 9.2, 3.1, 5.3)\nsum(round(decimals))\n\n[1] 40\n\n\nAs you can see the command is quite hard to read and it becomes harder if you apply more than two functions. One nice alternative is the mentioned %&gt;% operator. Note that most of the time it is not nessary to add () behind a function’s name.\n\ndecimals &lt;- c(2.5, 1.2, 3.6, 4.1, 4.6, 7.3, 9.2, 3.1, 5.3)\nround(decimals) %&gt;% sum\n\n[1] 40\n\n\nThis helps already a lot. But we can make it even more easier to read.\n\ndecimals &lt;- c(2.5, 1.2, 3.6, 4.1, 4.6, 7.3, 9.2, 3.1, 5.3)\ndecimals %&gt;% round %&gt;% sum\n\n[1] 40\n\n\nAs you can see we can directly pipe the the vector called decimals to round() and the output to sum()."
  },
  {
    "objectID": "useful_R.html#count-the-number-of-occurences-with-the-table-function",
    "href": "useful_R.html#count-the-number-of-occurences-with-the-table-function",
    "title": "Some useful R",
    "section": "Count the number of occurences with the table function",
    "text": "Count the number of occurences with the table function\nOften we have a data.frame column with some specific information that we want to summarize. Here the table() function is helpful as it counts how often a certain string or value is found in the column.\nAssume we have a data.frame that stores the regulation of eight genes (A to H) and we want to know how many genes are upregulated, not regulated or downregulated. We can easily solve this task with table().\n\nregulationDataFrame &lt;- data.frame(\n  gene=c(\"A\", \"B\", \"C\", \"D\",\"E\", \"F\", \"G\", \"H\"),\n  regulation=c(\"up\", \"down\", \"up\", \"no\", \"no\", \"down\", \"up\", \"up\")\n)\ntable(regulationDataFrame$regulation)\n\n\ndown   no   up \n   2    2    4 \n\n\nAs you can see we now have a nice overview about the regulation. One nice feature of table() is that you can provide more than one column as input.\nFor instance we could also have information about the gene type and want to summarize the regulation across the different gene types. Here is an easy example, where we have 3 gene types, namely protein-coding, miRNA and rRNA.\n\nregulationDataFrame$type = c(\"protein-coding\", \"rRNA\", \"protein-coding\", \"miRNA\",\n           \"miRNA\", \"rRNA\", \"protein-coding\", \"protein-coding\")\n\ntable(regulationDataFrame$type, regulationDataFrame$regulation)\n\n                \n                 down no up\n  miRNA             0  2  0\n  protein-coding    0  0  4\n  rRNA              2  0  0\n\n\nWe can see that the upregulated genes are encoding for proteins, while the downregulated genes encode rRNAs and the non-regulated ones miRNAs."
  },
  {
    "objectID": "useful_R.html#use-kable-to-make-a-table-or-data.frame-output-look-nicer",
    "href": "useful_R.html#use-kable-to-make-a-table-or-data.frame-output-look-nicer",
    "title": "Some useful R",
    "section": "Use kable to make a table or data.frame output look nicer",
    "text": "Use kable to make a table or data.frame output look nicer\nThe kable() function from the knitr package makes tables look nicer in the html/pdf reports.\n\ntable(regulationDataFrame$type, regulationDataFrame$regulation) %&gt;% kable()\n\n\n\n\n\ndown\nno\nup\n\n\n\n\nmiRNA\n0\n2\n0\n\n\nprotein-coding\n0\n0\n4\n\n\nrRNA\n2\n0\n0"
  },
  {
    "objectID": "useful_R.html#for-loops",
    "href": "useful_R.html#for-loops",
    "title": "Some useful R",
    "section": "for loops",
    "text": "for loops\nFor loops are the basic loop function in R. We will use it to loop over lists.\n\nfor(i in 1:5){\n  print(i)\n}\n\n[1] 1\n[1] 2\n[1] 3\n[1] 4\n[1] 5\n\nfor(i in 1:5){\n  y = i + 3\n  print(paste(i, \"+ 3 =\", y )) \n}\n\n[1] \"1 + 3 = 4\"\n[1] \"2 + 3 = 5\"\n[1] \"3 + 3 = 6\"\n[1] \"4 + 3 = 7\"\n[1] \"5 + 3 = 8\""
  },
  {
    "objectID": "useful_R.html#handling-of-data.frames",
    "href": "useful_R.html#handling-of-data.frames",
    "title": "Some useful R",
    "section": "Handling of data.frames",
    "text": "Handling of data.frames\nMost of the time we will work with with the results of the splicing analysis in data.frame format. There are several nice functions that help with data frames. Some of them are quickly shown in the following.\n\nAdding new columns with mutate\nThe mutate() function is an easy way to add new columns to a data.frame.\n\n# mutate can write the same word in every row\nregulationDataFrame %&gt;% mutate(newColumn = \"new\")\n\n  gene regulation           type newColumn\n1    A         up protein-coding       new\n2    B       down           rRNA       new\n3    C         up protein-coding       new\n4    D         no          miRNA       new\n5    E         no          miRNA       new\n6    F       down           rRNA       new\n7    G         up protein-coding       new\n8    H         up protein-coding       new\n\n# duplicate another row\nregulationDataFrame %&gt;% mutate(newColumn = gene)\n\n  gene regulation           type newColumn\n1    A         up protein-coding         A\n2    B       down           rRNA         B\n3    C         up protein-coding         C\n4    D         no          miRNA         D\n5    E         no          miRNA         E\n6    F       down           rRNA         F\n7    G         up protein-coding         G\n8    H         up protein-coding         H\n\n# or modify an existing column.\nregulationDataFrame %&gt;% \n  mutate(newColumn = paste0(regulation, \"-regulation\"))\n\n  gene regulation           type       newColumn\n1    A         up protein-coding   up-regulation\n2    B       down           rRNA down-regulation\n3    C         up protein-coding   up-regulation\n4    D         no          miRNA   no-regulation\n5    E         no          miRNA   no-regulation\n6    F       down           rRNA down-regulation\n7    G         up protein-coding   up-regulation\n8    H         up protein-coding   up-regulation\n\n\n\n\nUsing case_when to mutate conditionally\nmutate() can also be use conditionally by combining it with the case_when() function.\n\nregulationDataFrame %&gt;% \n  mutate(change = case_when( regulation == \"no\" ~ \"no change\",\n                             T ~ \"change\")\n         )\n\n  gene regulation           type    change\n1    A         up protein-coding    change\n2    B       down           rRNA    change\n3    C         up protein-coding    change\n4    D         no          miRNA no change\n5    E         no          miRNA no change\n6    F       down           rRNA    change\n7    G         up protein-coding    change\n8    H         up protein-coding    change\n\n\n\n\nPicking only certain rows (subset) or columns (select)\nWe can subset a data.frame to only the certein rows with the subset() function. For this we need to pass a logical argument to the subset function.\nQuick reminder: A logical statement will output a vector of TRUE or FALSE. Typical logical operators in R are == for is equal and != for is not equal. Another nice one is %in%, which checks if a value is inside a vector.\n\n# logical statements\nregulationDataFrame$regulation == \"up\"\n\n[1]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE\n\nregulationDataFrame$regulation != \"up\"\n\n[1] FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE\n\nregulationDataFrame$regulation %in% c(\"up\", \"down\")\n\n[1]  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE\n\n# subsetting for specific rows\nregulationDataFrame %&gt;% subset(regulation == \"up\")\n\n  gene regulation           type\n1    A         up protein-coding\n3    C         up protein-coding\n7    G         up protein-coding\n8    H         up protein-coding\n\n\n\n\nExtract certain patterns with grepl()\nThe grepl() function also returns a logical vector. It can be used to search for a specific pattern within a vector. This can then also be used together with subset, to subset a data.frame for the rows that contains this pattern in a specific row.\n\ngrepl(regulationDataFrame$type, pattern = \"protein-coding\")\n\n[1]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE\n\ngrepl(regulationDataFrame$type, pattern = \"protein\")\n\n[1]  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE  TRUE\n\nsubset(regulationDataFrame, grepl(regulationDataFrame$type, pattern = \"protein-coding\"))\n\n  gene regulation           type\n1    A         up protein-coding\n3    C         up protein-coding\n7    G         up protein-coding\n8    H         up protein-coding\n\n\n\n\nArranging data.frames\ndata.frames can be sorted by a speciffic coulmn or also by multiple columns with the arrange() function. arrange() sorts character columns by alphabetical order and numeric columns from lowest to highest. the function desc() can be used to sort from highest to lowest instead.\n\n# arranging a data.frame by a character column\nregulationDataFrame %&gt;% arrange(type)\n\n  gene regulation           type\n1    D         no          miRNA\n2    E         no          miRNA\n3    A         up protein-coding\n4    C         up protein-coding\n5    G         up protein-coding\n6    H         up protein-coding\n7    B       down           rRNA\n8    F       down           rRNA\n\n# arranging a data.frame by a numeric column\nregulationDataFrame$someNumber &lt;- c(1,5,8,2,2,4,3,5)\nregulationDataFrame %&gt;% arrange(someNumber)\n\n  gene regulation           type someNumber\n1    A         up protein-coding          1\n2    D         no          miRNA          2\n3    E         no          miRNA          2\n4    G         up protein-coding          3\n5    F       down           rRNA          4\n6    B       down           rRNA          5\n7    H         up protein-coding          5\n8    C         up protein-coding          8\n\n# arranging by two columns\nregulationDataFrame %&gt;% arrange(type, someNumber)\n\n  gene regulation           type someNumber\n1    D         no          miRNA          2\n2    E         no          miRNA          2\n3    A         up protein-coding          1\n4    G         up protein-coding          3\n5    H         up protein-coding          5\n6    C         up protein-coding          8\n7    F       down           rRNA          4\n8    B       down           rRNA          5\n\n# arranging from highest to lowest\nregulationDataFrame %&gt;% arrange(desc(someNumber))\n\n  gene regulation           type someNumber\n1    C         up protein-coding          8\n2    B       down           rRNA          5\n3    H         up protein-coding          5\n4    F       down           rRNA          4\n5    G         up protein-coding          3\n6    D         no          miRNA          2\n7    E         no          miRNA          2\n8    A         up protein-coding          1\n\n\n\n\nGrouping data.frames\n\nregulationDataFrame %&gt;% group_by(regulation) %&gt;% arrange(desc(someNumber), .by_group = T) \n\n# A tibble: 8 × 4\n# Groups:   regulation [3]\n  gene  regulation type           someNumber\n  &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;\n1 B     down       rRNA                    5\n2 F     down       rRNA                    4\n3 D     no         miRNA                   2\n4 E     no         miRNA                   2\n5 C     up         protein-coding          8\n6 H     up         protein-coding          5\n7 G     up         protein-coding          3\n8 A     up         protein-coding          1"
  },
  {
    "objectID": "splicing_index.html",
    "href": "splicing_index.html",
    "title": "Differential Splicing Analysis",
    "section": "",
    "text": "This is the splicing part of Spezialisierungspraktikum RNA Biology.\nIn brief, we visualize and explore the output a splicing analysis done with MAJIQ."
  },
  {
    "objectID": "splicing_index.html#what-is-splicing",
    "href": "splicing_index.html#what-is-splicing",
    "title": "Differential Splicing Analysis",
    "section": "What is splicing?",
    "text": "What is splicing?"
  },
  {
    "objectID": "splicing_index.html#what-are-splice-events-and-local-splice-variants-lsvs",
    "href": "splicing_index.html#what-are-splice-events-and-local-splice-variants-lsvs",
    "title": "Differential Splicing Analysis",
    "section": "What are splice events and local splice variants (LSVs)?",
    "text": "What are splice events and local splice variants (LSVs)?"
  },
  {
    "objectID": "splicing_index.html#splicing-classes",
    "href": "splicing_index.html#splicing-classes",
    "title": "Differential Splicing Analysis",
    "section": "What are the most common classes of splicing?",
    "text": "What are the most common classes of splicing?"
  },
  {
    "objectID": "splicing_index.html#what-are-psi-and-dpsi",
    "href": "splicing_index.html#what-are-psi-and-dpsi",
    "title": "Differential Splicing Analysis",
    "section": "What are PSI and dPSI?",
    "text": "What are PSI and dPSI?"
  },
  {
    "objectID": "splicing_index.html#what-is-the-probability-changing",
    "href": "splicing_index.html#what-is-the-probability-changing",
    "title": "Differential Splicing Analysis",
    "section": "What is the probability changing?",
    "text": "What is the probability changing?"
  },
  {
    "objectID": "splicing_index.html#majiq-workflow",
    "href": "splicing_index.html#majiq-workflow",
    "title": "Differential Splicing Analysis",
    "section": "How does the majiq workflow look like?",
    "text": "How does the majiq workflow look like?"
  },
  {
    "objectID": "splicing_index.html#what-are-the-output-files-from-majiq",
    "href": "splicing_index.html#what-are-the-output-files-from-majiq",
    "title": "Differential Splicing Analysis",
    "section": "What are the output files from majiq?",
    "text": "What are the output files from majiq?"
  }
]